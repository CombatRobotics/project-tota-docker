{
    "name": "TOTA ROS2 Development",
    "build": {
        "dockerfile": "Dockerfile",
        "context": ".",
        "args": {
            "BASE_IMAGE": "ghcr.io/combatrobotics/ros-humble-gz-base:latest",
            "INSTALL_CLAUDE": "true"
        }
    },

    "workspaceFolder": "/ros2_ws/project_tota",
    "workspaceMount": "source=${localWorkspaceFolder},target=/ros2_ws/project_tota,type=bind",

    "runArgs": [
        "--network=host",
        "--privileged",
        "--gpus=all",
        "--group-add=video",
        "--ipc=host",
        "--shm-size=16g",
        "--cap-add=SYS_PTRACE",
        "--security-opt=seccomp=unconfined"
    ],

    "containerEnv": {
        "DISPLAY": "${localEnv:DISPLAY}",
        "RMW_IMPLEMENTATION": "rmw_cyclonedds_cpp",
        "CYCLONEDDS_URI": "file:///ros2_ws/project_tota/cyclonedds.xml",
        "HSA_OVERRIDE_GFX_VERSION": "11.0.2",
        "ROCR_VISIBLE_DEVICES": "${localEnv:ROCR_VISIBLE_DEVICES}",
        "HIP_VISIBLE_DEVICES": "${localEnv:HIP_VISIBLE_DEVICES}"
    },

    "mounts": [
        "source=/tmp/.X11-unix,target=/tmp/.X11-unix,type=bind",
        "source=/dev,target=/dev,type=bind",
        "source=tota-claude-config,target=/root/.config/claude,type=volume",
        "source=tota-claude-data,target=/root/.local/share/claude,type=volume",
        "source=tota-claude-cache,target=/root/.cache/claude,type=volume",
        "source=tota-bash-history,target=/root/.bash_history_persistent,type=volume"
    ],

    "postCreateCommand": "/ros2_ws/project_tota/.devcontainer/scripts/post-create.sh",
    "postStartCommand": "/ros2_ws/project_tota/.devcontainer/scripts/post-start.sh",

    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-vscode.cpptools",
                "ms-iot.vscode-ros"
            ],
            "settings": {
                "python.defaultInterpreterPath": "/usr/bin/python3",
                "ros.distro": "humble"
            }
        }
    },

    "remoteUser": "root"
}